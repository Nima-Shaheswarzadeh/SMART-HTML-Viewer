<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<title>SMART HTML Viewer</title>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
<style>
:root {
  --primary-color: #2563eb;
  --secondary-color: #00aaff;
  --bg-color: #f5f5f5;
  --text-color: #0f172a;
  --icon-color: var(--primary-color);
  --glow-color: var(--secondary-color);
  --button-bg: #ffffff;
  --shadow-color: rgba(37, 99, 235, 0.35);
  --accent: var(--primary-color);
  --highlight-color: var(--secondary-color);
}
body.dark {
  --bg-color: #2d2d30;
  --text-color: #ffffff;
  --button-bg: #404040;
}

/* Ù†ÙˆØ§Ø± Ø±Ù†Ú¯ÛŒ Ø¨Ø§Ù„Ø§ */
.color-bar {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  height: 6px;
  background: linear-gradient(90deg, 
    var(--primary-color) 0%, 
    var(--secondary-color) 50%, 
    var(--primary-color) 100%);
  z-index: 1000;
  cursor: pointer;
  transition: height 0.3s ease;
}
.color-bar:hover {
  height: 12px;
}

.color-controls {
  position: fixed;
  top: 15px;
  left: 20px;
  display: flex;
  gap: 10px;
  z-index: 1001;
  opacity: 0;
  transition: opacity 0.3s ease;
}
.color-bar:hover + .color-controls,
.color-controls:hover {
  opacity: 1;
}

.color-picker {
  width: 40px;
  height: 30px;
  border: none;
  border-radius: 10px;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

.reset-colors {
  padding: 6px 12px;
  background: rgba(255,255,255,0.9);
  border: none;
  border-radius: 10px;
  font-size: 12px;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0,0,0,0.2);
}

body {
  background: var(--bg-color);
  color: var(--text-color);
  font-family: 'Segoe UI', Tahoma, sans-serif;
  margin: 0;
  padding: 24px;
  padding-top: 30px;
  transition: background 0.25s ease, color 0.25s ease;
}
h1 {
  text-align: center;
  font-size: 2rem;
  margin-bottom: 18px;
  color: var(--accent);
  font-weight: bold;
  text-shadow: 0 2px 4px var(--shadow-color);
}
.toolbar {
  display: flex;
  justify-content: space-between;
  flex-wrap: wrap;
  gap: 10px;
  margin-bottom: 16px;
}
.group { display:flex; gap:10px; align-items:center; flex-wrap:wrap; }

/* Ú¯Ø±ÙˆÙ‡ Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯ÛŒØ¨Ø§Ú¯ Ùˆ ÙØ±Ù…Øª */
.action-group {
  display: flex;
  background: var(--button-bg);
  border-radius: 10px;
  box-shadow: 0 0 12px var(--shadow-color);
  overflow: hidden;
  border: 1px solid var(--accent);
}

.action-group button {
  width: 44px;
  height: 44px;
  border: none;
  background: transparent;
  display: flex;
  justify-content: center;
  align-items: center;
  font-size: 18px;
  cursor: pointer;
  transition: background 0.25s ease, transform 0.25s ease, box-shadow 0.25s ease;
  border-right: 1px solid rgba(0,0,0,0.1);
}

.action-group button:last-child {
  border-right: none;
}

.action-group button i {
  color: var(--icon-color);
  transition: color 0.25s ease;
}

.action-group button:hover {
  background: var(--accent);
  transform: scale(1.05);
  box-shadow: 0 0 18px var(--glow-color);
}

.action-group button:hover i {
  color: white;
}

.device-button, .action-btn {
  width: 44px; height: 44px; border-radius: 10px; border: none;
  background: var(--button-bg);
  display: inline-flex; justify-content: center; align-items: center;
  font-size: 18px; cursor: pointer;
  box-shadow: 0 0 12px var(--shadow-color);
  transition: transform 0.25s ease, box-shadow 0.25s ease;
}
.device-button i, .action-btn i { color: var(--icon-color); }
.device-button:hover, .action-btn:hover {
  transform: scale(1.15) rotate(5deg);
  box-shadow: 0 0 18px var(--glow-color);
}
.device-button.active {
  background: var(--accent);
}
.device-button.active i {
  color: white;
}

/* Ø¯Ú©Ù…Ù‡ Ù¾Ø§Ù¾â€ŒØ¢Ù¾ */
.popup-button {
  width: 44px; height: 44px; border-radius: 10px; border: none;
  background: var(--button-bg);
  display: inline-flex; justify-content: center; align-items: center;
  font-size: 18px; cursor: pointer;
  box-shadow: 0 0 12px var(--shadow-color);
  transition: transform 0.25s ease, box-shadow 0.25s ease;
  position: relative;
}
.popup-button i { color: var(--icon-color); }
.popup-button:hover {
  transform: scale(1.15) rotate(5deg);
  box-shadow: 0 0 18px var(--glow-color);
}

/* Ù…Ù†ÙˆÛŒ Ù¾Ø§Ù¾â€ŒØ¢Ù¾ */
.popup-menu {
  position: absolute;
  top: calc(100% + 8px);
  right: 0;
  background: var(--button-bg);
  border-radius: 10px;
  box-shadow: 0 0 12px var(--shadow-color);
  padding: 8px;
  z-index: 100;
  display: none;
  min-width: 180px;
  border: 1px solid var(--accent);
}
.popup-menu.open {
  display: block;
}
.popup-menu button {
  width: 100%;
  margin: 4px 0;
  padding: 10px 12px;
  font-size: 14px;
  border: none;
  background: var(--button-bg);
  color: var(--text-color);
  cursor: pointer;
  border-radius: 8px;
  display: flex;
  align-items: center;
  gap: 10px;
  transition: all 0.25s ease;
}
.popup-menu button i {
  color: var(--icon-color);
  width: 20px;
  text-align: center;
}
.popup-menu button:hover {
  background: var(--accent);
  color: #fff;
}
.popup-menu button:hover i {
  color: #fff;
}
.popup-menu .size-info {
  font-size: 11px;
  opacity: 0.7;
  margin-right: auto;
}

.dropdown { position: relative; }
.dropdown-content {
  position: absolute; top: calc(100% + 8px); right: 0;
  background: var(--button-bg); border-radius: 10px; box-shadow: 0 0 12px var(--shadow-color);
  padding: 8px; z-index: 10; display: none; min-width: 160px;
}
.dropdown.open .dropdown-content { display: block; }
.dropdown-content button {
  width: 100%; margin: 4px 0; padding: 8px 10px; font-size: 14px;
  border: none; background: var(--button-bg); color: var(--text-color);
  cursor: pointer; border-radius: 10px;
}
.dropdown-content button:hover { background: var(--accent); color: #fff; }
select, input[type="number"] {
  padding: 8px 10px; border-radius: 10px; border: 1px solid var(--accent);
  background: var(--button-bg); color: var(--text-color); font-size: 14px;
  box-shadow: 0 0 8px var(--shadow-color);
}

/* Ø§Ø³ØªØ§ÛŒÙ„ Ø¨Ø±Ø§ÛŒ Ù¾Ù†Ù„ Ø§Ø±ØªÙØ§Ø¹ */
.height-panel {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px;
  border-radius: 10px;
  background: var(--button-bg);
  border: 1px solid var(--accent);
  box-shadow: 0 0 8px var(--shadow-color);
  font-size: 14px;
}

.height-panel input {
  width: 70px;
  border: none;
  background: transparent;
  color: var(--text-color);
  font-size: 14px;
  text-align: center;
}

.height-panel input:focus {
  outline: none;
}

/* Ø³ÛŒØ³ØªÙ… ØªØ¨ */
.tabs-container {
  margin-top: 16px;
  background: var(--button-bg);
  border: 1px solid var(--accent);
  border-radius: 12px 12px 0 0;
  box-shadow: 0 0 12px var(--shadow-color);
  overflow: hidden;
}

.tabs-header {
  display: flex;
  background: var(--bg-color);
  border-bottom: 1px solid var(--accent);
  overflow-x: auto;
  scrollbar-width: none;
  -ms-overflow-style: none;
}

.tabs-header::-webkit-scrollbar {
  display: none;
}

.tab {
  display: flex;
  align-items: center;
  padding: 8px 12px;
  background: rgba(0,0,0,0.05);
  border-right: 1px solid var(--accent);
  cursor: pointer;
  transition: all 0.3s ease;
  min-width: 120px;
  max-width: 200px;
  position: relative;
  white-space: nowrap;
}

.tab.active {
  background: var(--button-bg);
  border-bottom: 2px solid var(--accent);
}

.tab:hover {
  background: var(--accent);
  color: white;
}

.tab.active:hover {
  background: var(--button-bg);
  color: var(--text-color);
}

.tab-name {
  flex: 1;
  font-size: 13px;
  font-weight: 500;
  overflow: hidden;
  text-overflow: ellipsis;
  padding: 2px 4px;
  border-radius: 4px;
  background: transparent;
  border: 1px solid transparent;
  color: inherit;
  outline: none;
  cursor: pointer;
  width: 100%;
  min-width: 60px;
}

.tab-name.editing {
  background: rgba(255,255,255,0.3);
  border: 1px solid var(--accent);
  cursor: text;
}

.tab-close {
  margin-right: 6px;
  width: 18px;
  height: 18px;
  border-radius: 50%;
  background: rgba(255,0,0,0.7);
  color: white;
  border: none;
  cursor: pointer;
  font-size: 11px;
  display: flex;
  align-items: center;
  justify-content: center;
  opacity: 0.7;
  transition: opacity 0.3s ease;
  flex-shrink: 0;
}

.tab-close:hover {
  opacity: 1;
  background: #ff0000;
}

.add-tab {
  padding: 8px 12px;
  background: transparent;
  border: none;
  cursor: pointer;
  color: var(--accent);
  font-size: 16px;
  transition: all 0.3s ease;
  min-width: 44px;
  display: flex;
  align-items: center;
  justify-content: center;
  flex-shrink: 0;
}

.add-tab:hover {
  background: var(--accent);
  color: white;
}

.editor {
  width: 100%; min-height: 220px;
  padding: 12px; border-radius: 0 0 10px 10px; border: none;
  background: var(--button-bg); color: var(--text-color);
  font-family: monospace; font-size: 14px; resize: vertical;
  border-top: 1px solid var(--accent);
}
.preview-wrap {
  margin-top: 16px;
  background: var(--button-bg);
  border: 1px solid var(--accent);
  border-radius: 12px;
  box-shadow: 0 0 12px var(--shadow-color);
  overflow: hidden;
}
.preview-header {
  display: flex; justify-content: space-between; align-items: center;
  padding: 8px 12px; border-bottom: 1px solid var(--accent);
  font-size: 13px;
}
.chip {
  padding: 4px 8px; border-radius: 10px;
  background: rgba(0,0,0,0.06);
  border: 1px solid var(--accent);
  font-size: 12px;
}
iframe {
  display: block;
  width: 100%;
  height: 220px;
  background: #fff;
  border: none;
}

/* ÙÙˆØªØ± */
footer { 
  text-align: center; 
  margin-top: 18px; 
  font-size: 13px; 
  opacity: 0.85;
  line-height: 1.8;
}

footer .separator {
  color: var(--accent);
  text-shadow: 0 0 8px var(--shadow-color);
  font-weight: bold;
  margin: 0 2px;
}

.notification {
  position: fixed;
  top: 20px;
  right: 20px;
  background: var(--accent);
  color: white;
  padding: 12px 20px;
  border-radius: 10px;
  font-size: 14px;
  z-index: 1000;
  opacity: 0;
  transform: translateX(100%);
  transition: all 0.3s ease;
}
.notification.show {
  opacity: 1;
  transform: translateX(0);
}

/* Ù…ÙˆØ¯Ø§Ù„ Ø¯ÛŒØ¨Ø§Ú¯ */
.debug-modal {
  position: fixed;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(0,0,0,0.8);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 2000;
}

.debug-content {
  background: var(--button-bg);
  border-radius: 12px;
  padding: 20px;
  max-width: 90vw;
  max-height: 90vh;
  overflow: auto;
  box-shadow: 0 0 20px var(--shadow-color);
}

.debug-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 15px;
  padding-bottom: 10px;
  border-bottom: 1px solid var(--accent);
}

.debug-header h3 {
  margin: 0;
}

.debug-close {
  background: none;
  border: none;
  font-size: 24px;
  cursor: pointer;
  color: var(--text-color);
}

.debug-info {
  font-family: monospace;
  font-size: 12px;
  line-height: 1.5;
  color: var(--text-color);
  white-space: pre-wrap;
}

@media (max-width: 768px) {
  .toolbar {
    flex-direction: column;
    align-items: stretch;
  }
  .group {
    justify-content: center;
  }
  .color-controls {
    position: relative;
    top: auto;
    left: auto;
    opacity: 1;
    margin-bottom: 10px;
  }
  body {
    padding-top: 50px;
  }
}
</style>
</head>
<body>
<!-- Ù†ÙˆØ§Ø± Ø±Ù†Ú¯ÛŒ -->
<div class="color-bar" id="colorBar"></div>
<div class="color-controls">
  <input type="color" id="primaryColorPicker" class="color-picker" value="#2563eb" title="Ø±Ù†Ú¯ Ø§ØµÙ„ÛŒ">
  <input type="color" id="secondaryColorPicker" class="color-picker" value="#00aaff" title="Ø±Ù†Ú¯ ÙØ±Ø¹ÛŒ">
  <button class="reset-colors" id="resetColors" title="Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø­Ø§Ù„Øª Ù¾ÛŒØ´ÙØ±Ø¶">
    <i class="fas fa-undo"></i>
  </button>
</div>

<h1 id="title">SMART HTML Viewer</h1>
<div class="toolbar">
  <div class="group">
    <button class="device-button active" data-device="laptop" title="Ù„Ù¾â€ŒØªØ§Ù¾"><i class="fas fa-laptop"></i></button>
    <button class="device-button" data-device="tablet" title="ØªØ¨Ù„Øª"><i class="fas fa-tablet-alt"></i></button>
    <button class="device-button" data-device="mobile" title="Ù…ÙˆØ¨Ø§ÛŒÙ„"><i class="fas fa-mobile-alt"></i></button>
    
    <!-- Ø¯Ú©Ù…Ù‡ Ù¾Ø§Ù¾â€ŒØ¢Ù¾ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ -->
    <div class="dropdown" id="popupDropdown">
      <button class="popup-button" title="Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¯Ø± Ù¾Ù†Ø¬Ø±Ù‡ Ø¬Ø¯ÛŒØ¯"><i class="fas fa-external-link-alt"></i></button>
      <div class="popup-menu" id="popupMenu">
        <button data-popup="laptop">
          <i class="fas fa-laptop"></i>
          <span>Ù„Ù¾â€ŒØªØ§Ù¾</span>
          <span class="size-info">1366Ã—768</span>
        </button>
        <button data-popup="tablet">
          <i class="fas fa-tablet-alt"></i>
          <span>ØªØ¨Ù„Øª</span>
          <span class="size-info">768Ã—1024</span>
        </button>
        <button data-popup="mobile">
          <i class="fas fa-mobile-alt"></i>
          <span>Ù…ÙˆØ¨Ø§ÛŒÙ„</span>
          <span class="size-info">375Ã—667</span>
        </button>
      </div>
    </div>
    
    <div class="height-panel">
      <span id="heightLabel">Ø§Ø±ØªÙØ§Ø¹:</span>
      <input id="heightInput" type="number" min="200" max="1200" step="20" value="220">
      <span>px</span>
    </div>
    <button class="action-btn" id="autoHeightBtn" title="ØªÙ†Ø¸ÛŒÙ… Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø±ØªÙØ§Ø¹"><i class="fas fa-arrows-alt-v"></i></button>
    <div class="action-group">
      <button id="debugBtn" title="Ø¯ÛŒØ¨Ø§Ú¯ Ú©Ø¯"><i class="fas fa-bug"></i></button>
      <button id="formatBtn" title="Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ú©Ø¯"><i class="fas fa-align-left"></i></button>
    </div>
  </div>
  <div class="group">
    <button class="action-btn" id="runBtn" title="Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø¯"><i class="fas fa-play"></i></button>
    <button class="action-btn" id="copyBtn" title="Ú©Ù¾ÛŒ"><i class="fas fa-copy"></i></button>
    <div class="dropdown" id="downloadDropdown">
      <button class="action-btn" title="Ø¯Ø§Ù†Ù„ÙˆØ¯"><i class="fas fa-download"></i></button>
      <div class="dropdown-content">
        <button data-type="html">Ø¯Ø§Ù†Ù„ÙˆØ¯ HTML</button>
        <button data-type="txt">Ø¯Ø§Ù†Ù„ÙˆØ¯ TXT</button>
      </div>
    </div>
    <select id="languageSelect" title="Ø²Ø¨Ø§Ù†">
      <option value="fa">ÙØ§Ø±Ø³ÛŒ</option>
      <option value="en">English</option>
      <option value="ar">Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</option>
      <option value="fr">FranÃ§ais</option>
      <option value="es">EspaÃ±ol</option>
      <option value="zh">ä¸­æ–‡</option>
      <option value="de">Deutsch</option>
    </select>
    <button class="action-btn" id="infoBtn" title="Ø§Ø·Ù„Ø§Ø¹Ø§Øª"><i class="fas fa-info-circle"></i></button>
    <button class="action-btn" id="themeToggle" title="ØªØºÛŒÛŒØ± Ø­Ø§Ù„Øª"><i class="fas fa-moon"></i></button>
  </div>
</div>
<!-- Ø³ÛŒØ³ØªÙ… ØªØ¨ -->
<div class="tabs-container">
  <div class="tabs-header" id="tabsHeader">
    <div class="tab active" data-tab="0">
      <span class="tab-name">ÙØ§ÛŒÙ„ Ø¬Ø¯ÛŒØ¯</span>
      <button class="tab-close">&times;</button>
    </div>
    <button class="add-tab" id="addTabBtn">
      <i class="fas fa-plus"></i>
    </button>
  </div>
  <textarea id="htmlInput" class="editor" placeholder="Ú©Ø¯ HTML Ø®ÙˆØ¯ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯..."></textarea>
</div>
<div class="preview-wrap">
  <div class="preview-header">
    <div class="left">
      <span id="previewLabel" class="chip">Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´</span>
      <span id="deviceLabel" class="chip">Ø¹Ø±Ø¶: 100%</span>
    </div>
    <span id="heightDisplay" class="chip">Ø§Ø±ØªÙØ§Ø¹: 220px</span>
  </div>
  <iframe id="preview"></iframe>
</div>
<footer>
  <strong>SMART HTML Viewer</strong> by <strong>Nima.Sh</strong>
  <br>
  HTML <span class="separator">|â€¢|</span> CSS <span class="separator">|â€¢|</span> JavaScript
</footer>

<div id="notification" class="notification"></div>

<!-- Ù…ÙˆØ¯Ø§Ù„ Ø¯ÛŒØ¨Ø§Ú¯ -->
<div id="debugModal" class="debug-modal">
  <div class="debug-content">
    <div class="debug-header">
      <h3 id="debugTitle">Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯ÛŒØ¨Ø§Ú¯ Ú©Ø¯</h3>
      <button class="debug-close" id="debugClose">&times;</button>
    </div>
    <div id="debugInfo" class="debug-info"></div>
  </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const titleEl = document.getElementById('title');
  const inputEl = document.getElementById('htmlInput');
  const iframeEl = document.getElementById('preview');
  const heightInput = document.getElementById('heightInput');
  const heightLabel = document.getElementById('heightLabel');
  const heightDisplay = document.getElementById('heightDisplay');
  const deviceLabel = document.getElementById('deviceLabel');
  const previewLabel = document.getElementById('previewLabel');
  const langSelect = document.getElementById('languageSelect');
  const themeToggle = document.getElementById('themeToggle');
  const runBtn = document.getElementById('runBtn');
  const copyBtn = document.getElementById('copyBtn');
  const dropdown = document.getElementById('downloadDropdown');
  const notification = document.getElementById('notification');
  const infoBtn = document.getElementById('infoBtn');
  const debugTitle = document.getElementById('debugTitle');
  
  // Ø¹Ù†Ø§ØµØ± Ø¬Ø¯ÛŒØ¯
  const autoHeightBtn = document.getElementById('autoHeightBtn');
  const debugBtn = document.getElementById('debugBtn');
  const formatBtn = document.getElementById('formatBtn');
  const primaryColorPicker = document.getElementById('primaryColorPicker');
  const secondaryColorPicker = document.getElementById('secondaryColorPicker');
  const resetColors = document.getElementById('resetColors');
  const debugModal = document.getElementById('debugModal');
  const debugClose = document.getElementById('debugClose');
  const debugInfo = document.getElementById('debugInfo');
  const addTabBtn = document.getElementById('addTabBtn');
  
  // Ø¹Ù†Ø§ØµØ± Ù¾Ø§Ù¾â€ŒØ¢Ù¾
  const popupDropdown = document.getElementById('popupDropdown');
  const popupMenu = document.getElementById('popupMenu');

  // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø§Ø¨Ø¹Ø§Ø¯ Ù¾Ù†Ø¬Ø±Ù‡ Ø¨Ø±Ø§ÛŒ Ù‡Ø± Ø¯Ø³ØªÚ¯Ø§Ù‡
  const deviceDimensions = {
    laptop: { width: 1366, height: 768, name: 'Ù„Ù¾â€ŒØªØ§Ù¾', nameEn: 'Laptop' },
    tablet: { width: 768, height: 1024, name: 'ØªØ¨Ù„Øª', nameEn: 'Tablet' },
    mobile: { width: 375, height: 667, name: 'Ù…ÙˆØ¨Ø§ÛŒÙ„', nameEn: 'Mobile' }
  };

  // Ù…ØªÙ†â€ŒÙ‡Ø§ÛŒ Ú†Ù†Ø¯Ø²Ø¨Ø§Ù†Ù‡
  const translations = {
    fa: {
      title: 'SMART HTML Viewer',
      placeholder: 'Ú©Ø¯ HTML Ø®ÙˆØ¯ Ø±Ø§ Ø§ÛŒÙ†Ø¬Ø§ Ø¨Ù†ÙˆÛŒØ³ÛŒØ¯...',
      preview: 'Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´',
      height: 'Ø§Ø±ØªÙØ§Ø¹',
      heightLabel: 'Ø§Ø±ØªÙØ§Ø¹:',
      width: 'Ø¹Ø±Ø¶',
      copied: 'Ú©Ø¯ Ú©Ù¾ÛŒ Ø´Ø¯!',
      downloadHtml: 'Ø¯Ø§Ù†Ù„ÙˆØ¯ HTML',
      downloadTxt: 'Ø¯Ø§Ù†Ù„ÙˆØ¯ TXT',
      laptop: 'Ù„Ù¾â€ŒØªØ§Ù¾',
      tablet: 'ØªØ¨Ù„Øª',
      mobile: 'Ù…ÙˆØ¨Ø§ÛŒÙ„',
      formatted: 'Ú©Ø¯ Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø´Ø¯!',
      autoHeight: 'Ø§Ø±ØªÙØ§Ø¹ Ø®ÙˆØ¯Ú©Ø§Ø± ØªÙ†Ø¸ÛŒÙ… Ø´Ø¯!',
      run: 'Ø§Ø¬Ø±Ø§ÛŒ Ú©Ø¯',
      copy: 'Ú©Ù¾ÛŒ',
      download: 'Ø¯Ø§Ù†Ù„ÙˆØ¯',
      language: 'Ø²Ø¨Ø§Ù†',
      info: 'Ø§Ø·Ù„Ø§Ø¹Ø§Øª',
      theme: 'ØªØºÛŒÛŒØ± Ø­Ø§Ù„Øª',
      debug: 'Ø¯ÛŒØ¨Ø§Ú¯ Ú©Ø¯',
      format: 'Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ú©Ø¯',
      autoHeightTitle: 'ØªÙ†Ø¸ÛŒÙ… Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø±ØªÙØ§Ø¹',
      primaryColor: 'Ø±Ù†Ú¯ Ø§ØµÙ„ÛŒ',
      secondaryColor: 'Ø±Ù†Ú¯ ÙØ±Ø¹ÛŒ',
      resetColorsTitle: 'Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø­Ø§Ù„Øª Ù¾ÛŒØ´ÙØ±Ø¶',
      newFile: 'ÙØ§ÛŒÙ„ Ø¬Ø¯ÛŒØ¯',
      debugInfo: 'Ø§Ø·Ù„Ø§Ø¹Ø§Øª Ø¯ÛŒØ¨Ø§Ú¯ Ú©Ø¯',
      codeStats: 'Ø¢Ù…Ø§Ø± Ú©Ø¯',
      lines: 'ØªØ¹Ø¯Ø§Ø¯ Ø®Ø·ÙˆØ·',
      characters: 'ØªØ¹Ø¯Ø§Ø¯ Ú©Ø§Ø±Ø§Ú©ØªØ±Ù‡Ø§',
      htmlTags: 'ØªÚ¯â€ŒÙ‡Ø§ÛŒ HTML',
      cssStyles: 'Ø§Ø³ØªØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ CSS',
      jsScripts: 'Ø§Ø³Ú©Ø±ÛŒÙ¾Øªâ€ŒÙ‡Ø§ÛŒ JS',
      tagCheck: 'Ø¨Ø±Ø±Ø³ÛŒ ØªÚ¯â€ŒÙ‡Ø§',
      unclosedTags: 'ØªÚ¯â€ŒÙ‡Ø§ÛŒ Ø¨Ø³ØªÙ‡ Ù†Ø´Ø¯Ù‡',
      allTagsClosed: 'Ù‡Ù…Ù‡ ØªÚ¯â€ŒÙ‡Ø§ Ø¨Ù‡ Ø¯Ø±Ø³ØªÛŒ Ø¨Ø³ØªÙ‡ Ø´Ø¯Ù‡â€ŒØ§Ù†Ø¯',
      suggestions: 'Ù¾ÛŒØ´Ù†Ù‡Ø§Ø¯Ø§Øª',
      addDoctype: 'DOCTYPE Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯',
      addCharset: 'charset ØªØ¹Ø±ÛŒÙ Ú©Ù†ÛŒØ¯',
      addTitle: 'Ø¹Ù†ÙˆØ§Ù† ØµÙØ­Ù‡ Ø§Ø¶Ø§ÙÙ‡ Ú©Ù†ÛŒØ¯',
      useSeparateCss: 'Ø§Ø² CSS Ø¬Ø¯Ø§Ú¯Ø§Ù†Ù‡ Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯',
      openInNewWindow: 'Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ø¯Ø± Ù¾Ù†Ø¬Ø±Ù‡ Ø¬Ø¯ÛŒØ¯',
      popupOpened: 'Ù¾Ù†Ø¬Ø±Ù‡ Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ Ø¨Ø§Ø² Ø´Ø¯!'
    },
    en: {
      title: 'SMART HTML Viewer',
      placeholder: 'Write your HTML code here...',
      preview: 'Preview',
      height: 'Height',
      heightLabel: 'Height:',
      width: 'Width',
      copied: 'Code copied!',
      downloadHtml: 'Download HTML',
      downloadTxt: 'Download TXT',
      laptop: 'Laptop',
      tablet: 'Tablet',
      mobile: 'Mobile',
      formatted: 'Code formatted!',
      autoHeight: 'Auto height applied!',
      run: 'Run code',
      copy: 'Copy',
      download: 'Download',
      language: 'Language',
      info: 'Info',
      theme: 'Toggle theme',
      debug: 'Debug code',
      format: 'Format code',
      autoHeightTitle: 'Auto adjust height',
      primaryColor: 'Primary color',
      secondaryColor: 'Secondary color',
      resetColorsTitle: 'Reset to default',
      newFile: 'New File',
      debugInfo: 'Debug Information',
      codeStats: 'Code Stats',
      lines: 'Lines',
      characters: 'Characters',
      htmlTags: 'HTML Tags',
      cssStyles: 'CSS Styles',
      jsScripts: 'JS Scripts',
      tagCheck: 'Tag Check',
      unclosedTags: 'Unclosed tags',
      allTagsClosed: 'All tags are properly closed',
      suggestions: 'Suggestions',
      addDoctype: 'Add DOCTYPE',
      addCharset: 'Define charset',
      addTitle: 'Add page title',
      useSeparateCss: 'Use separate CSS',
      openInNewWindow: 'Open in new window',
      popupOpened: 'Preview window opened!'
    },
    ar: {
      title: 'Ø¹Ø§Ø±Ø¶ HTML Ø§Ù„Ø°ÙƒÙŠ',
      placeholder: 'Ø§ÙƒØªØ¨ ÙƒÙˆØ¯ HTML Ù‡Ù†Ø§...',
      preview: 'Ù…Ø¹Ø§ÙŠÙ†Ø©',
      height: 'Ø§Ù„Ø§Ø±ØªÙØ§Ø¹',
      heightLabel: 'Ø§Ù„Ø§Ø±ØªÙØ§Ø¹:',
      width: 'Ø§Ù„Ø¹Ø±Ø¶',
      copied: 'ØªÙ… Ù†Ø³Ø® Ø§Ù„ÙƒÙˆØ¯!',
      downloadHtml: 'ØªØ­Ù…ÙŠÙ„ HTML',
      downloadTxt: 'ØªØ­Ù…ÙŠÙ„ TXT',
      laptop: 'Ø­Ø§Ø³ÙˆØ¨ Ù…Ø­Ù…ÙˆÙ„',
      tablet: 'Ø¬Ù‡Ø§Ø² Ù„ÙˆØ­ÙŠ',
      mobile: 'Ù‡Ø§ØªÙ',
      formatted: 'ØªÙ… ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¯!',
      autoHeight: 'ØªÙ… ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ Ø§Ù„ØªÙ„Ù‚Ø§Ø¦ÙŠ!',
      run: 'ØªØ´ØºÙŠÙ„ Ø§Ù„ÙƒÙˆØ¯',
      copy: 'Ù†Ø³Ø®',
      download: 'ØªØ­Ù…ÙŠÙ„',
      language: 'Ø§Ù„Ù„ØºØ©',
      info: 'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª',
      theme: 'ØªØ¨Ø¯ÙŠÙ„ Ø§Ù„Ø³Ù…Ø©',
      debug: 'ØªØµØ­ÙŠØ­ Ø§Ù„ÙƒÙˆØ¯',
      format: 'ØªÙ†Ø³ÙŠÙ‚ Ø§Ù„ÙƒÙˆØ¯',
      autoHeightTitle: 'Ø¶Ø¨Ø· Ø§Ù„Ø§Ø±ØªÙØ§Ø¹ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹',
      primaryColor: 'Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø£Ø³Ø§Ø³ÙŠ',
      secondaryColor: 'Ø§Ù„Ù„ÙˆÙ† Ø§Ù„Ø«Ø§Ù†ÙˆÙŠ',
      resetColorsTitle: 'Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªØ¹ÙŠÙŠÙ†',
      newFile: 'Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯',
      debugInfo: 'Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØµØ­ÙŠØ­',
      codeStats: 'Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø§Ù„ÙƒÙˆØ¯',
      lines: 'Ø§Ù„Ø£Ø³Ø·Ø±',
      characters: 'Ø§Ù„Ø£Ø­Ø±Ù',
      htmlTags: 'Ø¹Ù„Ø§Ù…Ø§Øª HTML',
      cssStyles: 'Ø£Ù†Ù…Ø§Ø· CSS',
      jsScripts: 'Ø³ÙƒØ±Ø¨ØªØ§Øª JS',
      tagCheck: 'ÙØ­Øµ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª',
      unclosedTags: 'Ø¹Ù„Ø§Ù…Ø§Øª ØºÙŠØ± Ù…ØºÙ„Ù‚Ø©',
      allTagsClosed: 'Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ù…ØºÙ„Ù‚Ø© Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­',
      suggestions: 'Ø§Ù‚ØªØ±Ø§Ø­Ø§Øª',
      addDoctype: 'Ø£Ø¶Ù DOCTYPE',
      addCharset: 'Ø­Ø¯Ø¯ charset',
      addTitle: 'Ø£Ø¶Ù Ø¹Ù†ÙˆØ§Ù† Ø§Ù„ØµÙØ­Ø©',
      useSeparateCss: 'Ø§Ø³ØªØ®Ø¯Ù… CSS Ù…Ù†ÙØµÙ„',
      openInNewWindow: 'ÙØªØ­ ÙÙŠ Ù†Ø§ÙØ°Ø© Ø¬Ø¯ÙŠØ¯Ø©',
      popupOpened: 'ØªÙ… ÙØªØ­ Ù†Ø§ÙØ°Ø© Ø§Ù„Ù…Ø¹Ø§ÙŠÙ†Ø©!'
    },
    fr: {
      title: 'Visionneuse HTML SMART',
      placeholder: 'Ã‰crivez votre code HTML ici...',
      preview: 'AperÃ§u',
      height: 'Hauteur',
      heightLabel: 'Hauteur:',
      width: 'Largeur',
      copied: 'Code copiÃ©!',
      downloadHtml: 'TÃ©lÃ©charger HTML',
      downloadTxt: 'TÃ©lÃ©charger TXT',
      laptop: 'Ordinateur portable',
      tablet: 'Tablette',
      mobile: 'Mobile',
      formatted: 'Code formatÃ©!',
      autoHeight: 'Hauteur automatique appliquÃ©e!',
      run: 'ExÃ©cuter le code',
      copy: 'Copier',
      download: 'TÃ©lÃ©charger',
      language: 'Langue',
      info: 'Info',
      theme: 'Changer le thÃ¨me',
      debug: 'DÃ©boguer le code',
      format: 'Formater le code',
      autoHeightTitle: 'Ajuster la hauteur automatiquement',
      primaryColor: 'Couleur principale',
      secondaryColor: 'Couleur secondaire',
      resetColorsTitle: 'RÃ©initialiser',
      newFile: 'Nouveau fichier',
      debugInfo: 'Informations de dÃ©bogage',
      codeStats: 'Statistiques du code',
      lines: 'Lignes',
      characters: 'CaractÃ¨res',
      htmlTags: 'Balises HTML',
      cssStyles: 'Styles CSS',
      jsScripts: 'Scripts JS',
      tagCheck: 'VÃ©rification des balises',
      unclosedTags: 'Balises non fermÃ©es',
      allTagsClosed: 'Toutes les balises sont correctement fermÃ©es',
      suggestions: 'Suggestions',
      addDoctype: 'Ajouter DOCTYPE',
      addCharset: 'DÃ©finir charset',
      addTitle: 'Ajouter un titre de page',
      useSeparateCss: 'Utiliser un CSS sÃ©parÃ©',
      openInNewWindow: 'Ouvrir dans une nouvelle fenÃªtre',
      popupOpened: 'FenÃªtre d\'aperÃ§u ouverte!'
    },
    es: {
      title: 'Visor HTML INTELIGENTE',
      placeholder: 'Escribe tu cÃ³digo HTML aquÃ­...',
      preview: 'Vista previa',
      height: 'Altura',
      heightLabel: 'Altura:',
      width: 'Ancho',
      copied: 'Â¡CÃ³digo copiado!',
      downloadHtml: 'Descargar HTML',
      downloadTxt: 'Descargar TXT',
      laptop: 'PortÃ¡til',
      tablet: 'Tableta',
      mobile: 'MÃ³vil',
      formatted: 'Â¡CÃ³digo formateado!',
      autoHeight: 'Â¡Altura automÃ¡tica aplicada!',
      run: 'Ejecutar cÃ³digo',
      copy: 'Copiar',
      download: 'Descargar',
      language: 'Idioma',
      info: 'Info',
      theme: 'Cambiar tema',
      debug: 'Depurar cÃ³digo',
      format: 'Formatear cÃ³digo',
      autoHeightTitle: 'Ajustar altura automÃ¡ticamente',
      primaryColor: 'Color principal',
      secondaryColor: 'Color secundario',
      resetColorsTitle: 'Restablecer',
      newFile: 'Nuevo archivo',
      debugInfo: 'InformaciÃ³n de depuraciÃ³n',
      codeStats: 'EstadÃ­sticas del cÃ³digo',
      lines: 'LÃ­neas',
      characters: 'Caracteres',
      htmlTags: 'Etiquetas HTML',
      cssStyles: 'Estilos CSS',
      jsScripts: 'Scripts JS',
      tagCheck: 'VerificaciÃ³n de etiquetas',
      unclosedTags: 'Etiquetas sin cerrar',
      allTagsClosed: 'Todas las etiquetas estÃ¡n correctamente cerradas',
      suggestions: 'Sugerencias',
      addDoctype: 'Agregar DOCTYPE',
      addCharset: 'Definir charset',
      addTitle: 'Agregar tÃ­tulo de pÃ¡gina',
      useSeparateCss: 'Usar CSS separado',
      openInNewWindow: 'Abrir en nueva ventana',
      popupOpened: 'Â¡Ventana de vista previa abierta!'
    },
    zh: {
      title: 'æ™ºèƒ½ HTML æŸ¥çœ‹å™¨',
      placeholder: 'åœ¨æ­¤å¤„ç¼–å†™æ‚¨çš„ HTML ä»£ç ...',
      preview: 'é¢„è§ˆ',
      height: 'é«˜åº¦',
      heightLabel: 'é«˜åº¦:',
      width: 'å®½åº¦',
      copied: 'ä»£ç å·²å¤åˆ¶ï¼',
      downloadHtml: 'ä¸‹è½½ HTML',
      downloadTxt: 'ä¸‹è½½ TXT',
      laptop: 'ç¬”è®°æœ¬ç”µè„‘',
      tablet: 'å¹³æ¿ç”µè„‘',
      mobile: 'æ‰‹æœº',
      formatted: 'ä»£ç å·²æ ¼å¼åŒ–ï¼',
      autoHeight: 'è‡ªåŠ¨é«˜åº¦å·²åº”ç”¨ï¼',
      run: 'è¿è¡Œä»£ç ',
      copy: 'å¤åˆ¶',
      download: 'ä¸‹è½½',
      language: 'è¯­è¨€',
      info: 'ä¿¡æ¯',
      theme: 'åˆ‡æ¢ä¸»é¢˜',
      debug: 'è°ƒè¯•ä»£ç ',
      format: 'æ ¼å¼åŒ–ä»£ç ',
      autoHeightTitle: 'è‡ªåŠ¨è°ƒæ•´é«˜åº¦',
      primaryColor: 'ä¸»è‰²',
      secondaryColor: 'æ¬¡è¦é¢œè‰²',
      resetColorsTitle: 'é‡ç½®',
      newFile: 'æ–°æ–‡ä»¶',
      debugInfo: 'è°ƒè¯•ä¿¡æ¯',
      codeStats: 'ä»£ç ç»Ÿè®¡',
      lines: 'è¡Œæ•°',
      characters: 'å­—ç¬¦æ•°',
      htmlTags: 'HTMLæ ‡ç­¾',
      cssStyles: 'CSSæ ·å¼',
      jsScripts: 'JSè„šæœ¬',
      tagCheck: 'æ ‡ç­¾æ£€æŸ¥',
      unclosedTags: 'æœªé—­åˆæ ‡ç­¾',
      allTagsClosed: 'æ‰€æœ‰æ ‡ç­¾å·²æ­£ç¡®é—­åˆ',
      suggestions: 'å»ºè®®',
      addDoctype: 'æ·»åŠ  DOCTYPE',
      addCharset: 'å®šä¹‰ charset',
      addTitle: 'æ·»åŠ é¡µé¢æ ‡é¢˜',
      useSeparateCss: 'ä½¿ç”¨å•ç‹¬çš„ CSS',
      openInNewWindow: 'åœ¨æ–°çª—å£ä¸­æ‰“å¼€',
      popupOpened: 'é¢„è§ˆçª—å£å·²æ‰“å¼€ï¼'
    },
    de: {
      title: 'SMART HTML Viewer',
      placeholder: 'Schreiben Sie Ihren HTML-Code hier...',
      preview: 'Vorschau',
      height: 'HÃ¶he',
      heightLabel: 'HÃ¶he:',
      width: 'Breite',
      copied: 'Code kopiert!',
      downloadHtml: 'HTML herunterladen',
      downloadTxt: 'TXT herunterladen',
      laptop: 'Laptop',
      tablet: 'Tablet',
      mobile: 'Handy',
      formatted: 'Code formatiert!',
      autoHeight: 'Automatische HÃ¶he angewendet!',
      run: 'Code ausfÃ¼hren',
      copy: 'Kopieren',
      download: 'Herunterladen',
      language: 'Sprache',
      info: 'Info',
      theme: 'Thema wechseln',
      debug: 'Code debuggen',
      format: 'Code formatieren',
      autoHeightTitle: 'HÃ¶he automatisch anpassen',
      primaryColor: 'Hauptfarbe',
      secondaryColor: 'SekundÃ¤rfarbe',
      resetColorsTitle: 'ZurÃ¼cksetzen',
      newFile: 'Neue Datei',
      debugInfo: 'Debug-Informationen',
      codeStats: 'Code-Statistiken',
      lines: 'Zeilen',
      characters: 'Zeichen',
      htmlTags: 'HTML-Tags',
      cssStyles: 'CSS-Stile',
      jsScripts: 'JS-Skripte',
      tagCheck: 'Tag-PrÃ¼fung',
      unclosedTags: 'Nicht geschlossene Tags',
      allTagsClosed: 'Alle Tags sind korrekt geschlossen',
      suggestions: 'VorschlÃ¤ge',
      addDoctype: 'DOCTYPE hinzufÃ¼gen',
      addCharset: 'Charset definieren',
      addTitle: 'Seitentitel hinzufÃ¼gen',
      useSeparateCss: 'Separates CSS verwenden',
      openInNewWindow: 'In neuem Fenster Ã¶ffnen',
      popupOpened: 'Vorschaufenster geÃ¶ffnet!'
    }
  };

  let currentLang = 'fa';
  let currentDevice = 'laptop';
  
  // Ø³ÛŒØ³ØªÙ… ØªØ¨
  let tabs = [
    { id: 0, name: 'ÙØ§ÛŒÙ„ Ø¬Ø¯ÛŒØ¯', content: '', active: true }
  ];
  let tabCounter = 1;

  // Ø°Ø®ÛŒØ±Ù‡ Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ ÙØ¹Ù„ÛŒ
  let currentPrimaryColor = '#2563eb';
  let currentSecondaryColor = '#00aaff';

  // ØªÙ†Ø¸ÛŒÙ… Ø­Ø§Ù„Øª Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ø±ÙˆØ´Ù†
  document.body.classList.remove('dark');
  themeToggle.querySelector('i').className = 'fas fa-moon';

  // ØªØºÛŒÛŒØ± Ø±Ù†Ú¯ ØªÙ… - Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡
  function updateThemeColors(primary, secondary) {
    currentPrimaryColor = primary;
    currentSecondaryColor = secondary;
    
    const root = document.documentElement;
    
    // ØªÙ†Ø¸ÛŒÙ… Ø±Ù†Ú¯â€ŒÙ‡Ø§ Ø±ÙˆÛŒ root
    root.style.setProperty('--primary-color', primary);
    root.style.setProperty('--secondary-color', secondary);
    root.style.setProperty('--icon-color', primary);
    root.style.setProperty('--glow-color', secondary);
    root.style.setProperty('--accent', primary);
    root.style.setProperty('--highlight-color', secondary);
    
    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø³Ø§ÛŒÙ‡â€ŒÙ‡Ø§
    const primaryRgb = hexToRgb(primary);
    if (primaryRgb) {
      const shadowColor = `rgba(${primaryRgb.r}, ${primaryRgb.g}, ${primaryRgb.b}, 0.35)`;
      root.style.setProperty('--shadow-color', shadowColor);
    }
  }

  function hexToRgb(hex) {
    const result = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(hex);
    return result ? {
      r: parseInt(result[1], 16),
      g: parseInt(result[2], 16),
      b: parseInt(result[3], 16)
    } : null;
  }

  // Ù†Ù…Ø§ÛŒØ´ Ø§Ø¹Ù„Ø§Ù†
  function showNotification(message) {
    notification.textContent = message;
    notification.classList.add('show');
    setTimeout(() => {
      notification.classList.remove('show');
    }, 3000);
  }

  // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø²Ø¨Ø§Ù† - Ø§ØµÙ„Ø§Ø­ Ø´Ø¯Ù‡
  function updateLanguage(lang) {
    currentLang = lang;
    const t = translations[lang];
    
    titleEl.textContent = t.title;
    inputEl.placeholder = t.placeholder;
    previewLabel.textContent = t.preview;
    heightLabel.textContent = t.heightLabel;
    
    dropdown.querySelector('[data-type="html"]').textContent = t.downloadHtml;
    dropdown.querySelector('[data-type="txt"]').textContent = t.downloadTxt;
    
    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¹Ù†Ø§ÙˆÛŒÙ† Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§
    document.querySelector('[data-device="laptop"]').title = t.laptop;
    document.querySelector('[data-device="tablet"]').title = t.tablet;
    document.querySelector('[data-device="mobile"]').title = t.mobile;
    runBtn.title = t.run;
    copyBtn.title = t.copy;
    dropdown.querySelector('.action-btn').title = t.download;
    langSelect.title = t.language;
    infoBtn.title = t.info;
    themeToggle.title = t.theme;
    debugBtn.title = t.debug;
    formatBtn.title = t.format;
    autoHeightBtn.title = t.autoHeightTitle;
    primaryColorPicker.title = t.primaryColor;
    secondaryColorPicker.title = t.secondaryColor;
    resetColors.title = t.resetColorsTitle;
    debugTitle.textContent = t.debugInfo;
    
    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ø¯Ú©Ù…Ù‡ Ù¾Ø§Ù¾â€ŒØ¢Ù¾
    popupDropdown.querySelector('.popup-button').title = t.openInNewWindow;
    
    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù…ØªÙ†â€ŒÙ‡Ø§ÛŒ Ù…Ù†ÙˆÛŒ Ù¾Ø§Ù¾â€ŒØ¢Ù¾
    popupMenu.querySelector('[data-popup="laptop"] span:first-of-type').textContent = t.laptop;
    popupMenu.querySelector('[data-popup="tablet"] span:first-of-type').textContent = t.tablet;
    popupMenu.querySelector('[data-popup="mobile"] span:first-of-type').textContent = t.mobile;
    
    if (lang === 'ar' || lang === 'fa') {
      document.documentElement.dir = 'rtl';
      document.documentElement.lang = lang;
    } else {
      document.documentElement.dir = 'ltr';
      document.documentElement.lang = lang;
    }
    
    // Ø¨Ù‡â€ŒØ±ÙˆØ²Ø±Ø³Ø§Ù†ÛŒ Ù†Ø§Ù… ØªØ¨â€ŒÙ‡Ø§ Ø§Ú¯Ø± Ù¾ÛŒØ´â€ŒÙØ±Ø¶ Ù‡Ø³ØªÙ†Ø¯
    tabs.forEach((tab, index) => {
      if (tab.name === 'ÙØ§ÛŒÙ„ Ø¬Ø¯ÛŒØ¯' || tab.name === 'New File' || 
          tab.name === 'Ù…Ù„Ù Ø¬Ø¯ÙŠØ¯' || tab.name === 'Nouveau fichier' ||
          tab.name === 'Nuevo archivo' || tab.name === 'æ–°æ–‡ä»¶' || 
          tab.name === 'Neue Datei' || tab.name.startsWith('ÙØ§ÛŒÙ„ ') ||
          tab.name.startsWith('File ')) {
        if (index === 0 && tabs.length === 1) {
          tab.name = t.newFile;
        }
      }
    });
    renderTabs();
    
    updateDeviceLabel();
    updateHeightDisplay();
  }

  function updateDeviceLabel() {
    const t = translations[currentLang];
    let width = '100%';
    
    switch (currentDevice) {
      case 'tablet':
        width = '768px';
        break;
      case 'mobile':
        width = '375px';
        break;
    }
    
    deviceLabel.textContent = `${t.width}: ${width}`;
  }

  function updateHeightDisplay() {
    const t = translations[currentLang];
    heightDisplay.textContent = `${t.height}: ${heightInput.value}px`;
  }

  function changeDevice(device) {
    currentDevice = device;
    
    document.querySelectorAll('.device-button').forEach(btn => {
      btn.classList.remove('active');
    });
    
    document.querySelector(`[data-device="${device}"]`).classList.add('active');
    
    switch (device) {
      case 'laptop':
        iframeEl.style.width = '100%';
        iframeEl.style.maxWidth = 'none';
        break;
      case 'tablet':
        iframeEl.style.width = '768px';
        iframeEl.style.maxWidth = '100%';
        break;
      case 'mobile':
        iframeEl.style.width = '375px';
        iframeEl.style.maxWidth = '100%';
        break;
    }
    
    updateDeviceLabel();
  }

  function runCode() {
    const htmlCode = inputEl.value;
    const iframe = iframeEl;
    
    iframe.src = 'data:text/html;charset=utf-8,' + encodeURIComponent(htmlCode);
  }

  // ØªØ§Ø¨Ø¹ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù¾Ù†Ø¬Ø±Ù‡ Ù¾Ø§Ù¾â€ŒØ¢Ù¾
  function openPreviewPopup(device) {
    const dimensions = deviceDimensions[device];
    const t = translations[currentLang];
    const deviceName = currentLang === 'fa' || currentLang === 'ar' ? dimensions.name : dimensions.nameEn;
    const windowTitle = `${deviceName} - SMART HTML Viewer`;
    
    // ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾Ù†Ø¬Ø±Ù‡
    const windowFeatures = [
      `width=${dimensions.width}`,
      `height=${dimensions.height}`,
      'resizable=yes',
      'scrollbars=yes',
      'menubar=no',
      'toolbar=no',
      'location=no',
      'status=yes'
    ].join(',');
    
    // Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù¾Ù†Ø¬Ø±Ù‡ Ø¬Ø¯ÛŒØ¯
    const popupWindow = window.open('', windowTitle, windowFeatures);
    
    if (popupWindow) {
      // Ù…Ø­ØªÙˆØ§ÛŒ HTML ÙØ¹Ù„ÛŒ
      const htmlContent = inputEl.value;
      
      // Ù†ÙˆØ´ØªÙ† Ù…Ø­ØªÙˆØ§ Ø¯Ø± Ù¾Ù†Ø¬Ø±Ù‡ Ø¬Ø¯ÛŒØ¯
      popupWindow.document.open();
      popupWindow.document.write(htmlContent);
      popupWindow.document.close();
      
      // ØªÙ†Ø¸ÛŒÙ… Ø¹Ù†ÙˆØ§Ù† Ù¾Ù†Ø¬Ø±Ù‡
      popupWindow.document.title = windowTitle;
      
      // Ù†Ù…Ø§ÛŒØ´ Ø§Ø¹Ù„Ø§Ù†
      showNotification(t.popupOpened);
      
      // Ø¨Ø³ØªÙ† Ù…Ù†ÙˆÛŒ Ù¾Ø§Ù¾â€ŒØ¢Ù¾
      popupMenu.classList.remove('open');
    } else {
      // Ø§Ú¯Ø± Ù¾Ø§Ù¾â€ŒØ¢Ù¾ Ø¨Ù„Ø§Ú© Ø´Ø¯Ù‡ Ø¨ÙˆØ¯
      alert('Ù„Ø·ÙØ§Ù‹ Ø§Ø¬Ø§Ø²Ù‡ Ø¨Ø§Ø² Ø´Ø¯Ù† Ù¾Ù†Ø¬Ø±Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø§Ù¾â€ŒØ¢Ù¾ Ø±Ø§ Ø¨Ø¯Ù‡ÛŒØ¯.');
    }
  }

  async function copyCode() {
    try {
      await navigator.clipboard.writeText(inputEl.value);
      showNotification(translations[currentLang].copied);
    } catch (err) {
      inputEl.select();
      document.execCommand('copy');
      showNotification(translations[currentLang].copied);
    }
  }

  function downloadFile(type) {
    const content = inputEl.value;
    const filename = type === 'html' ? 'code.html' : 'code.txt';
    const mimeType = type === 'html' ? 'text/html' : 'text/plain';
    
    const blob = new Blob([content], { type: mimeType });
    const url = URL.createObjectURL(blob);
    
    const a = document.createElement('a');
    a.href = url;
    a.download = filename;
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
  }

  // ØªÙ†Ø¸ÛŒÙ… Ø®ÙˆØ¯Ú©Ø§Ø± Ø§Ø±ØªÙØ§Ø¹
  function autoAdjustHeight() {
    const lines = inputEl.value.split('\n').length;
    const newHeight = Math.max(220, Math.min(800, lines * 20 + 40));
    heightInput.value = newHeight;
    iframeEl.style.height = newHeight + 'px';
    updateHeightDisplay();
    showNotification(translations[currentLang].autoHeight);
  }

  // Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ú©Ø¯
  function formatCode() {
    let code = inputEl.value;
    
    // Ù…Ø±ØªØ¨â€ŒØ³Ø§Ø²ÛŒ Ø³Ø§Ø¯Ù‡ HTML
    code = code
      .replace(/>\s*</g, '>\n<')
      .replace(/^\s+|\s+$/gm, '')
      .split('\n')
      .map(line => line.trim())
      .filter(line => line.length > 0)
      .join('\n');
    
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø§ÛŒÙ†Ø¯Ù†Øª
    const lines = code.split('\n');
    let indentLevel = 0;
    const formattedLines = [];
    
    lines.forEach(line => {
      if (line.match(/^<\//) && !line.match(/<[^\/][^>]*>[^<]*<\/[^>]+>/)) {
        indentLevel = Math.max(0, indentLevel - 1);
      }
      
      formattedLines.push('  '.repeat(indentLevel) + line);
      
      if (line.match(/<[^\/!][^>]*[^\/]>/) && !line.match(/<\//) && !line.match(/\/>/)) {
        indentLevel++;
      }
    });
    
    inputEl.value = formattedLines.join('\n');
    saveCurrentTab();
    runCode();
    showNotification(translations[currentLang].formatted);
  }

  // Ø¯ÛŒØ¨Ø§Ú¯ Ú©Ø¯
  function debugCode() {
    const t = translations[currentLang];
    const code = inputEl.value;
    const lines = code.split('\n');
    
    let debugOutput = `ğŸ“Š ${t.codeStats}:\n`;
    debugOutput += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
    debugOutput += `ğŸ“ ${t.lines}: ${lines.length}\n`;
    debugOutput += `ğŸ”¤ ${t.characters}: ${code.length}\n`;
    debugOutput += `ğŸ·ï¸  ${t.htmlTags}: ${(code.match(/<[^>]+>/g) || []).length}\n`;
    debugOutput += `ğŸ¨ ${t.cssStyles}: ${(code.match(/[^{}]+{[^}]*}/g) || []).length}\n`;
    debugOutput += `âš™ï¸  ${t.jsScripts}: ${(code.match(/<script[\s\S]*?<\/script>/gi) || []).length}\n\n`;
    
    debugOutput += `ğŸ” ${t.tagCheck}:\n`;
    debugOutput += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
    
    const openTags = (code.match(/<([a-zA-Z][a-zA-Z0-9]*)[^>]*(?<!\/)\s*>/g) || [])
      .map(tag => {
        const match = tag.match(/<([a-zA-Z][a-zA-Z0-9]*)/);
        return match ? match[1].toLowerCase() : null;
      })
      .filter(Boolean);
    
    const closeTags = (code.match(/<\/([a-zA-Z][a-zA-Z0-9]*)>/g) || [])
      .map(tag => {
        const match = tag.match(/<\/([a-zA-Z][a-zA-Z0-9]*)>/);
        return match ? match[1].toLowerCase() : null;
      })
      .filter(Boolean);
    
    const selfClosingTags = ['img', 'br', 'hr', 'input', 'meta', 'link', 'area', 'base', 'col', 'embed', 'param', 'source', 'track', 'wbr'];
    
    const openCount = {};
    const closeCount = {};
    
    openTags.forEach(tag => {
      if (!selfClosingTags.includes(tag)) {
        openCount[tag] = (openCount[tag] || 0) + 1;
      }
    });
    
    closeTags.forEach(tag => {
      closeCount[tag] = (closeCount[tag] || 0) + 1;
    });
    
    const unclosedTags = [];
    for (const tag in openCount) {
      const diff = openCount[tag] - (closeCount[tag] || 0);
      if (diff > 0) {
        unclosedTags.push(`${tag} (${diff})`);
      }
    }
    
    if (unclosedTags.length > 0) {
      debugOutput += `âš ï¸  ${t.unclosedTags}: ${unclosedTags.join(', ')}\n`;
    } else {
      debugOutput += `âœ… ${t.allTagsClosed}\n`;
    }
    
    debugOutput += `\nğŸ¯ ${t.suggestions}:\n`;
    debugOutput += `â”â”â”â”â”â”â”â”â”â”â”â”â”â”\n`;
    
    if (!code.includes('<!DOCTYPE html>') && !code.includes('<!doctype html>')) {
      debugOutput += `ğŸ’¡ ${t.addDoctype}\n`;
    }
    if (!code.includes('<meta charset=')) {
      debugOutput += `ğŸ’¡ ${t.addCharset}\n`;
    }
    if (!code.includes('<title>')) {
      debugOutput += `ğŸ’¡ ${t.addTitle}\n`;
    }
    if (code.includes('style=')) {
      debugOutput += `ğŸ’¡ ${t.useSeparateCss}\n`;
    }
    
    debugInfo.textContent = debugOutput;
    debugModal.style.display = 'flex';
  }

  // Event Listeners
  
  // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¯Ø³ØªÚ¯Ø§Ù‡
  document.querySelectorAll('.device-button').forEach(btn => {
    btn.addEventListener('click', () => {
      const device = btn.dataset.device;
      changeDevice(device);
    });
  });

  // Ù…Ù†ÙˆÛŒ Ù¾Ø§Ù¾â€ŒØ¢Ù¾
  popupDropdown.querySelector('.popup-button').addEventListener('click', (e) => {
    e.stopPropagation();
    popupMenu.classList.toggle('open');
  });
  
  // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ù¾Ø§Ù¾â€ŒØ¢Ù¾
  popupMenu.querySelectorAll('[data-popup]').forEach(btn => {
    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      const device = btn.dataset.popup;
      openPreviewPopup(device);
    });
  });

  heightInput.addEventListener('input', () => {
    const height = heightInput.value;
    iframeEl.style.height = height + 'px';
    updateHeightDisplay();
  });

  // Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ÛŒ Ø¬Ø¯ÛŒØ¯
  autoHeightBtn.addEventListener('click', autoAdjustHeight);
  debugBtn.addEventListener('click', debugCode);
  formatBtn.addEventListener('click', formatCode);

  // Ù…ÙˆØ¯Ø§Ù„ Ø¯ÛŒØ¨Ø§Ú¯
  debugClose.addEventListener('click', () => {
    debugModal.style.display = 'none';
  });
  
  debugModal.addEventListener('click', (e) => {
    if (e.target === debugModal) {
      debugModal.style.display = 'none';
    }
  });

  // Ø§Ù†ØªØ®Ø§Ø¨Ú¯Ø± Ø±Ù†Ú¯
  primaryColorPicker.addEventListener('input', (e) => {
    updateThemeColors(e.target.value, secondaryColorPicker.value);
  });

  secondaryColorPicker.addEventListener('input', (e) => {
    updateThemeColors(primaryColorPicker.value, e.target.value);
  });

  // Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ù¾ÛŒØ´ÙØ±Ø¶
  resetColors.addEventListener('click', () => {
    const isDark = document.body.classList.contains('dark');
    if (isDark) {
      primaryColorPicker.value = '#00ff7f';
      secondaryColorPicker.value = '#32cd32';
      updateThemeColors('#00ff7f', '#32cd32');
    } else {
      primaryColorPicker.value = '#2563eb';
      secondaryColorPicker.value = '#00aaff';
      updateThemeColors('#2563eb', '#00aaff');
    }
  });

  runBtn.addEventListener('click', runCode);
  copyBtn.addEventListener('click', copyCode);

  dropdown.addEventListener('click', (e) => {
    if (e.target.classList.contains('action-btn') || e.target.closest('.action-btn')) {
      dropdown.classList.toggle('open');
    }
  });

  dropdown.querySelectorAll('[data-type]').forEach(btn => {
    btn.addEventListener('click', () => {
      downloadFile(btn.dataset.type);
      dropdown.classList.remove('open');
    });
  });

  document.addEventListener('click', (e) => {
    if (!dropdown.contains(e.target)) {
      dropdown.classList.remove('open');
    }
    if (!popupDropdown.contains(e.target)) {
      popupMenu.classList.remove('open');
    }
  });

  langSelect.addEventListener('change', () => {
    updateLanguage(langSelect.value);
  });

  themeToggle.addEventListener('click', () => {
    document.body.classList.toggle('dark');
    const isDark = document.body.classList.contains('dark');
    themeToggle.querySelector('i').className = isDark ? 'fas fa-sun' : 'fas fa-moon';
    
    // ØªØºÛŒÛŒØ± Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨Ú¯Ø± Ø¨Ø± Ø§Ø³Ø§Ø³ ØªÙ… Ùˆ Ø§Ø¹Ù…Ø§Ù„ ÙÙˆØ±ÛŒ
    if (isDark) {
      primaryColorPicker.value = '#00ff7f';
      secondaryColorPicker.value = '#32cd32';
      updateThemeColors('#00ff7f', '#32cd32');
    } else {
      primaryColorPicker.value = '#2563eb';
      secondaryColorPicker.value = '#00aaff';
      updateThemeColors('#2563eb', '#00aaff');
    }
  });

  infoBtn.addEventListener('click', () => {
    window.open('https://nima-shaheswarzadeh.github.io', '_blank');
  });

  // Ø³ÛŒØ³ØªÙ… ØªØ¨ - ØªÙˆØ§Ø¨Ø¹
  
  // Ø°Ø®ÛŒØ±Ù‡ Ù…Ø­ØªÙˆØ§ÛŒ ØªØ¨ ÙØ¹Ù„ÛŒ
  function saveCurrentTab() {
    const activeTab = tabs.find(tab => tab.active);
    if (activeTab) {
      activeTab.content = inputEl.value;
    }
  }

  // ØªØºÛŒÛŒØ± ØªØ¨ ÙØ¹Ø§Ù„
  function switchTab(tabId) {
    saveCurrentTab();
    
    // ØªØºÛŒÛŒØ± ÙˆØ¶Ø¹ÛŒØª ØªØ¨â€ŒÙ‡Ø§
    tabs.forEach(tab => tab.active = false);
    const targetTab = tabs.find(tab => tab.id === tabId);
    if (targetTab) {
      targetTab.active = true;
      inputEl.value = targetTab.content;
      runCode();
    }
    
    renderTabs();
  }

  // Ø±Ù†Ø¯Ø± Ú©Ø±Ø¯Ù† ØªØ¨â€ŒÙ‡Ø§
  function renderTabs() {
    const tabsHeader = document.getElementById('tabsHeader');
    
    // Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† ØªØ¨â€ŒÙ‡Ø§ÛŒ Ù…ÙˆØ¬ÙˆØ¯ (Ø¨Ù‡ Ø¬Ø² Ø¯Ú©Ù…Ù‡ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù†)
    const existingTabs = tabsHeader.querySelectorAll('.tab');
    existingTabs.forEach(tab => tab.remove());
    
    // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ØªØ¨â€ŒÙ‡Ø§ Ù‚Ø¨Ù„ Ø§Ø² Ø¯Ú©Ù…Ù‡ add
    tabs.forEach((tab, index) => {
      const tabEl = document.createElement('div');
      tabEl.className = `tab ${tab.active ? 'active' : ''}`;
      tabEl.dataset.tab = tab.id;
      
      const tabName = document.createElement('span');
      tabName.className = 'tab-name';
      tabName.textContent = tab.name;
      
      const closeBtn = document.createElement('button');
      closeBtn.className = 'tab-close';
      closeBtn.innerHTML = '&times;';
      
      tabEl.appendChild(tabName);
      tabEl.appendChild(closeBtn);
      
      // Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ ØªØ¨
      tabEl.addEventListener('click', (e) => {
        if (!e.target.classList.contains('tab-close') && 
            !e.target.classList.contains('tab-name') &&
            !e.target.classList.contains('editing')) {
          switchTab(tab.id);
        }
      });
      
      // Ø¯Ø§Ø¨Ù„ Ú©Ù„ÛŒÚ© Ø¨Ø±Ø§ÛŒ ÙˆÛŒØ±Ø§ÛŒØ´ Ù†Ø§Ù…
      tabName.addEventListener('dblclick', (e) => {
        e.stopPropagation();
        startEditingTabName(tabName, tab);
      });
      
      // Ú©Ù„ÛŒÚ© Ø±ÙˆÛŒ Ù†Ø§Ù… ØªØ¨ Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ (Ù†Ù‡ ÙˆÛŒØ±Ø§ÛŒØ´)
      tabName.addEventListener('click', (e) => {
        if (!tabName.classList.contains('editing')) {
          e.stopPropagation();
          switchTab(tab.id);
        }
      });
      
      // Ø¨Ø³ØªÙ† ØªØ¨
      if (tabs.length > 1) {
        closeBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          closeTab(tab.id);
        });
      } else {
        closeBtn.style.display = 'none';
      }
      
      tabsHeader.insertBefore(tabEl, addTabBtn);
    });
  }
  
  // Ø´Ø±ÙˆØ¹ ÙˆÛŒØ±Ø§ÛŒØ´ Ù†Ø§Ù… ØªØ¨
  function startEditingTabName(tabNameEl, tab) {
    tabNameEl.classList.add('editing');
    tabNameEl.contentEditable = true;
    tabNameEl.focus();
    
    // Ø§Ù†ØªØ®Ø§Ø¨ ØªÙ…Ø§Ù… Ù…ØªÙ†
    const range = document.createRange();
    range.selectNodeContents(tabNameEl);
    const sel = window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);
    
    const finishEditing = () => {
      tabNameEl.classList.remove('editing');
      tabNameEl.contentEditable = false;
      const newName = tabNameEl.textContent.trim();
      tab.name = newName || translations[currentLang].newFile;
      tabNameEl.textContent = tab.name;
    };
    
    tabNameEl.addEventListener('blur', finishEditing, { once: true });
    
    tabNameEl.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        tabNameEl.blur();
      } else if (e.key === 'Escape') {
        tabNameEl.textContent = tab.name;
        tabNameEl.blur();
      }
    });
  }

  // Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ØªØ¨ Ø¬Ø¯ÛŒØ¯
  function addNewTab() {
    saveCurrentTab();
    
    // ØºÛŒØ±ÙØ¹Ø§Ù„ Ú©Ø±Ø¯Ù† Ù‡Ù…Ù‡ ØªØ¨â€ŒÙ‡Ø§
    tabs.forEach(tab => tab.active = false);
    
    const t = translations[currentLang];
    
    // Ø§ÛŒØ¬Ø§Ø¯ ØªØ¨ Ø¬Ø¯ÛŒØ¯
    const newTab = {
      id: tabCounter++,
      name: `${t.newFile} ${tabCounter}`,
      content: '',
      active: true
    };
    
    tabs.push(newTab);
    inputEl.value = '';
    runCode();
    renderTabs();
  }

  // Ø¨Ø³ØªÙ† ØªØ¨
  function closeTab(tabId) {
    if (tabs.length <= 1) return;
    
    const tabIndex = tabs.findIndex(tab => tab.id === tabId);
    const wasActive = tabs[tabIndex].active;
    
    tabs.splice(tabIndex, 1);
    
    // Ø§Ú¯Ø± ØªØ¨ ÙØ¹Ø§Ù„ Ø­Ø°Ù Ø´Ø¯ØŒ ØªØ¨ Ø¨Ø¹Ø¯ÛŒ ÛŒØ§ Ù‚Ø¨Ù„ÛŒ Ø±Ø§ ÙØ¹Ø§Ù„ Ú©Ù†
    if (wasActive && tabs.length > 0) {
      const nextIndex = Math.min(tabIndex, tabs.length - 1);
      tabs[nextIndex].active = true;
      inputEl.value = tabs[nextIndex].content;
      runCode();
    }
    
    renderTabs();
  }

  // Event Listener Ø¨Ø±Ø§ÛŒ Ø¯Ú©Ù…Ù‡ Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† ØªØ¨
  addTabBtn.addEventListener('click', addNewTab);

  // Ø°Ø®ÛŒØ±Ù‡ ØªØºÛŒÛŒØ±Ø§Øª Ù‡Ù†Ú¯Ø§Ù… ØªØ§ÛŒÙ¾
  let timeout;
  inputEl.addEventListener('input', () => {
    saveCurrentTab();
    clearTimeout(timeout);
    timeout = setTimeout(runCode, 500);
  });

  updateLanguage('fa');
  changeDevice('laptop');
  
  // Ù…Ø­ØªÙˆØ§ÛŒ Ù¾ÛŒØ´ÙØ±Ø¶ ØªØ¨ Ø§ÙˆÙ„
  tabs[0].content = `<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SMART HTML Viewer - Ù†Ù…Ø§ÛŒØ´Ú¯Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ HTML</title>
  <!-- Ù„ÙˆØ¯ ÙÙˆÙ†Øª -->
  <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;700&display=swap" rel="stylesheet">
  <style>
    /* ================== ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ù¾Ø§ÛŒÙ‡ ================== */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    body {
      font-family: 'Vazirmatn', 'Segoe UI', Tahoma, sans-serif;
      color: #fff;
      text-align: center;
      padding: 20px;
      overflow-x: hidden;
      background: radial-gradient(circle at 20% 30%, #1e1f27, #0a0a0d 80%);
      min-height: 100vh;
    }

    /* ================== Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ù…ØªØ­Ø±Ú© Ù†Ø¦ÙˆÙ†ÛŒ ================== */
    .tech-bg {
      position: fixed;
      top: 0; left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
    }
    .circle {
      position: absolute;
      border-radius: 50%;
      background: rgba(0,0,255,0.15);
      animation: move 20s infinite ease-in-out alternate;
      filter: blur(60px);
    }
    @keyframes move {
      0% { transform: translate(0,0) scale(1); }
      25% { transform: translate(70px,-50px) scale(1.2); }
      50% { transform: translate(-50px,90px) scale(1.3); }
      75% { transform: translate(80px,-40px) scale(1.1); }
      100% { transform: translate(0,0) scale(1); }
    }

    /* ================== Ú©Ø§Ø±Øª Ø§ØµÙ„ÛŒ ================== */
    .container {
      max-width: 900px;
      margin: 60px auto;
      background: rgba(255,255,255,0.05);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 25px;
      padding: 50px;
      box-shadow: 0 10px 40px rgba(0,0,255,0.3),0 10px 60px rgba(128,0,255,0.3);
      position: relative;
      animation: fadeIn 1.5s ease-out;
    }
    @keyframes fadeIn {
      from { opacity:0; transform:translateY(30px); }
      to { opacity:1; transform:translateY(0); }
    }

    /* ================== Ù„ÙˆÚ¯Ùˆ ================== */
    .logo {
      font-family: 'Vazirmatn', sans-serif;
      font-size: 3rem;
      font-weight: bold;
      margin-bottom: 10px;
      color: #00f5d4;
      text-shadow: 0 0 10px #00f5d4, 0 0 20px #00f5d4, 0 0 30px #00f5d4;
      display: inline-block;
      animation: logoMove 4s infinite ease-in-out;
    }
    @keyframes logoMove {
      0% { 
        transform: scale(1) rotate(0deg); 
        text-shadow: 0 0 10px #00f5d4, 0 0 20px #00f5d4, 0 0 30px #00f5d4; 
      }
      25% { 
        transform: scale(1.05) rotate(2deg); 
        text-shadow: 0 0 15px #00f5d4, 0 0 30px #00f5d4, 0 0 45px #00f5d4; 
      }
      50% { 
        transform: scale(1.1) rotate(-2deg); 
        text-shadow: 0 0 20px #00f5d4, 0 0 40px #00f5d4, 0 0 60px #00f5d4; 
      }
      75% { 
        transform: scale(1.05) rotate(1deg); 
        text-shadow: 0 0 15px #00f5d4, 0 0 30px #00f5d4, 0 0 45px #00f5d4; 
      }
      100% { 
        transform: scale(1) rotate(0deg); 
        text-shadow: 0 0 10px #00f5d4, 0 0 20px #00f5d4, 0 0 30px #00f5d4; 
      }
    }

    /* ================== Ø²ÛŒØ±Ø¹Ù†ÙˆØ§Ù† ================== */
    .subtitle {
      font-size:1.2rem;
      opacity:0.85;
      margin-bottom:40px;
      color:#dcdcdc;
      text-shadow: 0 0 5px #1E3A8A, 0 0 10px #7C3AED;
    }

    /* ================== Ú¯Ø±ÛŒØ¯ ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ ================== */
    .feature-grid {
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
      gap:25px;
      margin:40px 0;
    }

    /* ================== Ú©Ø§Ø±Øªâ€ŒÙ‡Ø§ÛŒ ÙˆÛŒÚ˜Ú¯ÛŒ ================== */
    .feature-card {
      background: rgba(0,0,0,0.2);
      padding:25px;
      border-radius:25px;
      transition: transform 0.5s ease, box-shadow 0.5s ease, background 0.5s ease;
      border:1px solid rgba(0,0,255,0.2);
      box-shadow:0 4px 15px rgba(0,0,255,0.3),0 4px 20px rgba(128,0,255,0.2);
    }
    .feature-card:hover {
      transform:translateY(-10px) scale(1.05);
      box-shadow:0 10px 35px rgba(0,0,255,0.5),0 10px 50px rgba(128,0,255,0.4);
      background: rgba(0,0,255,0.1);
    }
    .feature-icon {
      font-size:2.4rem;
      margin-bottom:10px;
      animation: float 3s infinite ease-in-out;
    }
    @keyframes float { 
      0%,100%{transform:translateY(0);} 
      50%{transform:translateY(-10px);} 
    }
    .feature-title {
      font-weight:bold;
      font-size:1.2rem;
      margin-bottom:5px;
      color:#00f5d4;
      text-shadow:0 0 5px #1E3A8A,0 0 10px #7C3AED;
    }
    .feature-desc {
      color: #b0b0b0;
      font-size: 0.95rem;
    }

    /* ================== Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ ================== */
    @keyframes btnGradient {
      0%{background-position:0% 50%;}
      50%{background-position:100% 50%;}
      100%{background-position:0% 50%;}
    }
    .cta-button {
      background: linear-gradient(45deg,#1E3A8A,#7C3AED,#1E3A8A);
      background-size:200% 200%;
      color:#fff;
      padding:15px 40px;
      border:none;
      border-radius:25px;
      font-size:1.2rem;
      font-weight:bold;
      cursor:pointer;
      transition: transform 0.5s ease, box-shadow 0.5s ease;
      margin:20px 10px;
      text-decoration:none;
      display:inline-block;
      animation: btnGradient 6s ease infinite;
      box-shadow:0 0 25px rgba(30,58,138,0.5),0 0 35px rgba(124,58,237,0.4);
      font-family: 'Vazirmatn', sans-serif;
    }
    .cta-button:hover {
      transform:scale(1.08);
      box-shadow:0 0 50px rgba(30,58,138,0.8),0 0 60px rgba(124,58,237,0.7);
    }

    /* ================== Ù…ØªÙ† Ù¾Ø§ÛŒÛŒÙ†ÛŒ ================== */
    .credits {
      margin-top:50px;
      opacity:0.9;
      font-size:0.95rem;
      color:#b0b0b0;
      text-shadow:0 0 5px #1E3A8A,0 0 10px #7C3AED;
      line-height: 1.8;
    }

    /* ================== ÙˆØ§Ú©Ù†Ø´â€ŒÚ¯Ø±Ø§ÛŒÛŒ ================== */
    @media(max-width:600px){
      .logo{font-size:2rem;}
      .container{padding:25px; margin: 30px auto;}
      .feature-grid{grid-template-columns:1fr;}
      .cta-button{
        display: block;
        margin: 15px auto;
        width: 80%;
      }
    }
  </style>
</head>
<body>

  <!-- Ù¾Ø³â€ŒØ²Ù…ÛŒÙ†Ù‡ Ù…ØªØ­Ø±Ú© -->
  <div class="tech-bg">
    <div class="circle" style="width:250px;height:250px;top:20%;left:10%;animation-delay:0s;"></div>
    <div class="circle" style="width:400px;height:400px;top:50%;left:70%;animation-delay:2s;"></div>
    <div class="circle" style="width:300px;height:300px;top:80%;left:20%;animation-delay:4s;"></div>
    <div class="circle" style="width:350px;height:350px;top:30%;left:80%;animation-delay:6s;"></div>
    <div class="circle" style="width:200px;height:200px;top:70%;left:50%;animation-delay:8s;"></div>
  </div>

  <!-- Ú©Ø§Ø±Øª Ø§ØµÙ„ÛŒ -->
  <div class="container">
    <div class="logo">SMART HTML Viewer</div>
    <div class="subtitle">Ù†Ù…Ø§ÛŒØ´Ú¯Ø± Ù‡ÙˆØ´Ù…Ù†Ø¯ Ùˆ Ù¾ÛŒØ´Ø±ÙØªÙ‡ Ú©Ø¯Ù‡Ø§ÛŒ HTML Ø¨Ø§ Ø·Ø±Ø§Ø­ÛŒ Ù…Ø¯Ø±Ù† Ùˆ Ø§Ù†ÛŒÙ…ÛŒØ´Ù†â€ŒÙ‡Ø§ÛŒ Ù†Ø¦ÙˆÙ†ÛŒ âœ¨</div>

    <!-- ÙˆÛŒÚ˜Ú¯ÛŒâ€ŒÙ‡Ø§ -->
    <div class="feature-grid">
      <div class="feature-card">
        <div class="feature-icon">ğŸ”¥</div>
        <div class="feature-title">Ø§Ø¬Ø±Ø§ÛŒ Ø²Ù†Ø¯Ù‡</div>
        <div class="feature-desc">Ù¾ÛŒØ´â€ŒÙ†Ù…Ø§ÛŒØ´ ÙÙˆØ±ÛŒ Ú©Ø¯Ù‡Ø§ÛŒ HTML</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">ğŸ“±</div>
        <div class="feature-title">ÙˆØ§Ú©Ù†Ø´â€ŒÚ¯Ø±Ø§</div>
        <div class="feature-desc">Ù†Ù…Ø§ÛŒØ´ Ø¯Ø± Ø³Ø§ÛŒØ²Ù‡Ø§ÛŒ Ù…Ø®ØªÙ„Ù Ø¯Ø³ØªÚ¯Ø§Ù‡</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">ğŸ¨</div>
        <div class="feature-title">Ø´Ø®ØµÛŒâ€ŒØ³Ø§Ø²ÛŒ</div>
        <div class="feature-desc">ØªÙ…â€ŒÙ‡Ø§ Ùˆ Ø±Ù†Ú¯â€ŒÙ‡Ø§ÛŒ Ù‚Ø§Ø¨Ù„ ØªÙ†Ø¸ÛŒÙ…</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">ğŸŒ</div>
        <div class="feature-title">Ú†Ù†Ø¯Ø²Ø¨Ø§Ù†Ù‡</div>
        <div class="feature-desc">Ù¾Ø´ØªÛŒØ¨Ø§Ù†ÛŒ Ø§Ø² 7 Ø²Ø¨Ø§Ù† Ù…Ø®ØªÙ„Ù</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">ğŸ“</div>
        <div class="feature-title">Ø³ÛŒØ³ØªÙ… ØªØ¨</div>
        <div class="feature-desc">Ú©Ø§Ø± Ù‡Ù…Ø²Ù…Ø§Ù† Ø±ÙˆÛŒ Ú†Ù†Ø¯ÛŒÙ† Ù¾Ø±ÙˆÚ˜Ù‡</div>
      </div>
      <div class="feature-card">
        <div class="feature-icon">ğŸ”§</div>
        <div class="feature-title">Ø§Ø¨Ø²Ø§Ø±Ù‡Ø§ÛŒ Ù¾ÛŒØ´Ø±ÙØªÙ‡</div>
        <div class="feature-desc">Ø¯ÛŒØ¨Ø§Ú¯ØŒ ÙØ±Ù…Øª Ùˆ ØªÙ†Ø¸ÛŒÙ…Ø§Øª Ø®ÙˆØ¯Ú©Ø§Ø±</div>
      </div>
    </div>

    <!-- Ø¯Ú©Ù…Ù‡â€ŒÙ‡Ø§ -->
    <a href="https://nima-shaheswarzadeh.github.io/SMART-HTML-Viewer/" class="cta-button" target="_blank">ğŸš€ Ø´Ø±ÙˆØ¹ Ú©Ù†ÛŒØ¯</a>
    <a href="https://github.com/Nima-Shaheswarzadeh/SMART-HTML-Viewer" class="cta-button" target="_blank">ğŸ“‚ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ø¯ Ù…Ù†Ø¨Ø¹</a>

    <!-- Ù…ØªÙ† Ù¾Ø§ÛŒØ§Ù†ÛŒ -->
    <div class="credits">
      SMART HTML Viewer by Nima.Sh <br>
      HTML |â€¢| CSS |â€¢| JavaScript
    </div>
  </div>

</body>
</html>
</body>
</html>`;
  
  inputEl.value = tabs[0].content;
  renderTabs();
  runCode();
});
</script>
</body>
</html>
